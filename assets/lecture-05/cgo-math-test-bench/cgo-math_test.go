package main

import "testing"
import "math"

// T1
func TestSinLibC(t *testing.T) {
	expected := 0.178058
	got := Csin(0.179013)
	if math.Abs(expected-got) > 0.000001 {
		t.Errorf("Expected: %f, Got: %f", expected, got)
	}
}

// T1
var datacos = []struct {
	input    float64
	expected float64
}{
	{1.000000, 0.540302},
	{0.000000, 1.000000},
	{0.922018, 0.604213},
	{0.697502, 0.766449},
	{0.649966, 0.796104},
}

// T2
func TestCosC(t *testing.T) {
	for count, i := range datacos {
		if testing.Short() && count > 5 {
			t.Skip("Running shorter test.")
		}
		got := Ccos(i.input)
		if math.Abs(i.expected-got) > 0.000001 {
			t.Errorf("Expected: %f, Got: %f", i.expected, got)
		}
	}
}

// T2
var datagamma = []float64{
	0.6628236482,
	0.0929215899,
	0.3987069529,
	0.4485221257,
	0.1619492446,
	0.9500627390,
	0.3888582701,
	0.2207648015,
	0.9498572757,
	0.7443433359,
	0.7285507029,
	0.4858349775,
	0.2902232432,
	0.6714308934,
	0.2203044819,
	0.5557157101,
	0.1748309292,
	0.0875854161,
	0.8468766175,
	0.4986947600,
	0.2908972519,
	0.6990785122,
	0.1026593488,
	0.2777080226,
	0.0905090271,
	0.7183146684,
	0.4863039636,
	0.3153710047,
	0.2297102790,
	0.4965083255,
	0.1437400637,
	0.2656054752,
	0.7225851783,
	0.3858329038,
	0.2999683085,
	0.6077976199,
	0.1979928281,
	0.2239129614,
	0.7817168966,
	0.4151783640,
	0.7515919876,
	0.6348503739,
	0.1366838244,
	0.3333487988,
	0.4456575894,
	0.8934775142,
	0.7611114931,
	0.3199577157,
	0.7904105606,
	0.4451070451,
	0.5234204147,
	0.4830483182,
	0.0112052405,
	0.7707650782,
	0.5173013970,
	0.5737877879,
	0.4340759687,
	0.7997269631,
	0.5775782726,
	0.1754735240,
	0.0154434692,
	0.6515583564,
	0.4642315537,
	0.5547416260,
	0.3296163148,
	0.4360941651,
	0.7193941994,
	0.5212460827,
	0.4600738948,
	0.6192830166,
	0.5703887927,
	0.0810138414,
	0.8977520342,
	0.4668801128,
	0.2675283719,
	0.6163727056,
	0.9114705080,
	0.5507669541,
	0.5335786823,
	0.3704567495,
	0.5417105800,
	0.0115753825,
	0.3736539316,
	0.8997247222,
	0.8916297093,
	0.7313774663,
	0.6988142385,
	0.0412399505,
	0.5266697712,
	0.8006658631,
	0.8079407005,
	0.8180169856,
	0.1409878509,
	0.2170852701,
	0.8015899107,
	0.4014340063,
	0.2904804330,
	0.1623445281,
	0.0852672515,
	0.5725041425,
	0.2430985407,
	0.4481054780,
	0.3022392234,
	0.4411344904,
	0.0794860570,
	0.2499276458,
	0.6625886021,
	0.5144428491,
	0.4636016969,
	0.8546217698,
	0.3553366348,
	0.6819037278,
	0.1557459026,
	0.8239327717,
	0.3218855627,
	0.9373541432,
	0.4492033116,
	0.4150349537,
	0.0265741878,
	0.0699305057,
	0.7530143185,
	0.9962744978,
	0.7154263803,
	0.3692890696,
	0.0647952232,
	0.5001386222,
	0.7539926431,
	0.0512059759,
	0.7539948494,
	0.0919953429,
	0.2031869912,
	0.7034598312,
	0.5723928490,
	0.1123685379,
	0.1654339180,
	0.2430161512,
	0.0769228361,
	0.9023038420,
	0.3727999583,
	0.4491554772,
	0.4846084370,
	0.6250810442,
	0.3191034543,
	0.7080977540,
	0.5867075242,
	0.5301204181,
	0.8428755256,
	0.7662909200,
	0.6137575709,
	0.0917473310,
	0.3554560166,
	0.7040334217,
	0.9083878767,
	0.2947829954,
	0.9275983301,
	0.3021549696,
	0.3523712552,
	0.6509919515,
	0.6289088373,
	0.1372830190,
	0.5655911687,
	0.1520112839,
	0.1299862032,
	0.5019416373,
	0.4362134799,
	0.3095873837,
	0.5257714435,
	0.5507656516,
	0.1603641535,
	0.7279198253,
	0.5877444095,
	0.1407477100,
	0.0552160004,
	0.3796948032,
	0.0141635438,
	0.8891480292,
	0.0710440209,
	0.6239096544,
	0.9658085007,
	0.3378159118,
	0.9844567146,
	0.8528034004,
	0.4479458794,
	0.9819279867,
	0.0926034528,
	0.2457478301,
	0.6788000080,
	0.6305800934,
	0.2027541524,
	0.3361499163,
	0.4297609176,
	0.1903451788,
	0.4841007259,
	0.1553910419,
	0.4753203240,
	0.7427834156,
	0.5256906386,
	0.2731117018,
	0.0453643460,
	0.1545875549,
	0.4067995476,
	0.1876372751,
	0.2254788517,
	0.3953398718,
	0.7761249348,
	0.2487773950,
	0.3187139633,
	0.8766449193,
	0.4555723174,
	0.7983456740,
	0.0984630673,
	0.4775238351,
	0.7501102514,
	0.7823368869,
	0.7778797518,
	0.3277300616,
	0.1589361358,
	0.1282949057,
	0.0673177197,
	0.6391878762,
	0.2675387612,
	0.1543166950,
	0.4690849413,
	0.7796371369,
	0.1518436687,
	0.3615470711,
	0.9531915234,
	0.5450007068,
	0.6229302807,
	0.9006011497,
	0.5076846366,
	0.8553253332,
	0.9134219639,
	0.1893357189,
	0.8422784534,
	0.4093100457,
	0.3090981319,
	0.5986179424,
	0.0978708064,
	0.8250503716,
	0.2302773052,
	0.6155378031,
	0.3768093697,
	0.3122054259,
	0.2515409203,
	0.5907308030,
	0.4908824403,
	0.4837779290,
	0.5112791149,
	0.9063670469,
	0.2484592961,
	0.4033092545,
	0.7788957523,
	0.9816676246,
	0.1203105422,
	0.7023519699,
	0.9049047122,
	0.3544195731,
	0.0608157810,
	0.0397097213,
	0.8998188050,
	0.1234827707,
	0.3661978418,
	0.4945876123,
	0.9691351973,
	0.5727177846,
	0.8889099843,
	0.8908482000,
	0.1225219724,
	0.1525342839,
	0.0201229312,
	0.7033395707,
	0.3494498169,
	0.4295543444,
	0.6903027486,
	0.5518571640,
	0.9420258505,
	0.4528557669,
	0.3301572677,
	0.5673486498,
	0.5093424385,
	0.5526129374,
	0.1340747280,
	0.0639497846,
	0.5522083904,
	0.6049413423,
	0.0386112325,
	0.4468430920,
	0.4805577326,
	0.5344619491,
	0.4155730276,
	0.4579570086,
	0.7247830473,
	0.4403584212,
	0.3343443281,
	0.6853440608,
	0.2593053030,
	0.6994744600,
	0.3689808733,
	0.9014848619,
	0.6880860230,
	0.6474063285,
	0.2290866487,
	0.1518839998,
	0.1474461117,
	0.7229051962,
	0.3046495174,
	0.3417065044,
	0.3372782768,
	0.1997312925,
	0.8606636615,
	0.5360778871,
	0.0193117335,
	0.7282513336,
	0.8549691513,
	0.0659556421,
	0.9884980838,
	0.5004050575,
	0.2644130663,
	0.4277616917,
	0.4721571500,
	0.1622577858,
	0.0224128626,
	0.8374817026,
	0.5110679208,
	0.6892813569,
	0.5607039769,
	0.0747788163,
	0.1387522752,
	0.6324408207,
	0.2367261785,
	0.4663527571,
	0.9019338711,
	0.8866232886,
	0.2575016871,
	0.3272114007,
	0.9565302301,
	0.4087035886,
	0.1341095558,
	0.7187571694,
	0.2645977201,
	0.1975770566,
	0.2689817964,
	0.2116321353,
	0.5081174086,
	0.0876065957,
	0.0971816475,
	0.5559463590,
	0.4190142386,
	0.0449551031,
	0.9950092089,
	0.7877788710,
	0.0319589072,
	0.5040558967,
	0.2171487031,
	0.0593806764,
	0.9784974556,
	0.4975154771,
	0.1135222226,
	0.6791178609,
	0.4556505264,
	0.5136710404,
	0.0547822416,
	0.0532503774,
	0.9013796976,
	0.2972297607,
	0.2928125962,
	0.9765675850,
	0.0227738968,
	0.5922749552,
	0.8398713909,
	0.9742559689,
	0.8361724539,
	0.0837787690,
	0.5553284677,
	0.8692669303,
	0.1958011211,
	0.3529080518,
	0.6399409480,
	0.3412622644,
	0.3245885134,
	0.0370440593,
	0.6334079439,
	0.5712280596,
	0.5322303545,
	0.3606980237,
	0.4564498440,
	0.0026993846,
	0.2500052293,
	0.2149872063,
	0.0667558557,
	0.0478215998,
	0.2571881326,
	0.5695566084,
	0.8212420309,
	0.2854632261,
	0.5733403764,
	0.4327132455,
	0.4479230499,
	0.4547671103,
	0.7784919238,
	0.9046953975,
	0.6282374547,
	0.5152338601,
	0.9088650641,
	0.5227141569,
	0.7525783619,
	0.6805927176,
	0.7695141811,
	0.9698361106,
	0.1853812842,
	0.2505609727,
	0.0674809487,
	0.1323011998,
	0.8319667205,
	0.2945669847,
	0.1228123769,
	0.0438946639,
	0.8802662078,
	0.4495157131,
	0.0778024526,
	0.9021106928,
	0.2005368925,
	0.9511191652,
	0.2091885309,
	0.5163725616,
	0.4924546128,
	0.5320029948,
	0.7670033597,
	0.3871130024,
	0.3011061817,
	0.1896019911,
	0.8599471592,
	0.4285543860,
	0.4909595435,
	0.3068105829,
	0.4677476357,
	0.2993046882,
	0.1236911599,
	0.4107630959,
	0.4248338925,
	0.8044537623,
	0.8480272052,
	0.8112608702,
	0.8147583655,
	0.5135072447,
	0.2075424878,
	0.6577718875,
	0.5400932725,
	0.5063385387,
	0.1089937405,
	0.9144275632,
	0.9274086254,
	0.6024819000,
	0.9595826572,
	0.5431528103,
	0.5036948719,
	0.4282358704,
	0.2868020418,
	0.1154263723,
	0.9334829553,
	0.4167666245,
	0.6182087368,
	0.3826091023,
	0.3103877366,
	0.5564615026,
	0.1473998949,
	0.1230769393,
	0.5866896852,
	0.8106093609,
	0.6300597419,
	0.9376677821,
	0.0192340998,
	0.6869319500,
	0.3755279001,
	0.7755560473,
	0.8093738618,
	0.8233005749,
	0.8452980659,
	0.4862986000,
	0.6267259697,
	0.6156611170,
	0.0326791629,
	0.0095657077,
	0.8232372167,
	0.6539744215,
	0.1223425732,
	0.7159268824,
	0.0491759856,
	0.5598108289,
	0.0434107624,
	0.1445130641,
	0.3012371383,
	0.0477463215,
	0.2026734998,
	0.2404739239,
	0.5099662100,
	0.5600912380,
	0.1590345418,
	0.5700087644,
	0.3090112114,
	0.8328108163,
	0.9793583437,
	0.4746928072,
	0.6704840498,
	0.1414757343,
	0.5410436055,
	0.9283021738,
	0.5893372781,
	0.4724340144,
	0.4676558480,
	0.9446535046,
	0.3397241669,
	0.4853646743,
	0.8297883846,
	0.4505168435,
	0.9878876306,
	0.0398786653,
	0.9722028457,
	0.5483173820,
	0.4133888220,
	0.2182111818,
	0.0147528711,
	0.7477704350,
	0.8924052651,
	0.7235877097,
	0.8326152317,
	0.6427762694,
	0.3123860791,
	0.2360815516,
	0.0978239272,
	0.1099223332,
	0.7824934866,
	0.1528993471,
	0.2929647255,
	0.4172192383,
	0.1686724763,
	0.1331542569,
	0.7111168148,
	0.1233199332,
	0.4733568159,
	0.2523311882,
	0.9938148312,
	0.3380513815,
	0.8243612090,
	0.3137891377,
	0.3553502964,
	0.4553093895,
	0.3872528230,
	0.1262728685,
	0.3607337183,
	0.5537319355,
	0.7674427479,
	0.3572073563,
	0.8202313195,
	0.8676834196,
	0.4337143151,
	0.2547369869,
	0.7938338115,
	0.9707946738,
	0.6314255401,
	0.5973732779,
	0.7433754497,
	0.9695908532,
	0.2008146807,
	0.7983429955,
	0.2215117465,
	0.3921560139,
	0.2380132094,
	0.1261633234,
	0.8426311524,
	0.0311277528,
	0.9624337578,
	0.5594761870,
	0.9971756202,
	0.5848324732,
	0.5514511584,
	0.4163564112,
	0.2844952553,
	0.2564752619,
	0.2378820412,
	0.7915295983,
	0.6811356900,
	0.0437551966,
	0.2180994920,
	0.3909123493,
	0.5373551114,
	0.1004822690,
	0.9677011602,
	0.9012215941,
	0.3021970266,
	0.9664375362,
	0.2607434850,
	0.2183413929,
	0.4637176941,
	0.4802248347,
	0.1610540220,
	0.6016446309,
	0.7867878262,
	0.4301678301,
	0.6789724713,
	0.5383814914,
	0.5777024456,
	0.2887301540,
	0.2500623712,
	0.0694256825,
	0.0782665914,
	0.1178671100,
	0.0475810584,
	0.8487003816,
	0.6483656535,
	0.2141464715,
	0.1421994085,
	0.5935466871,
	0.4836628997,
	0.9252652587,
	0.0252304247,
	0.8734188349,
	0.6205952831,
	0.7162901070,
	0.6671422653,
	0.5895037714,
	0.3658469325,
	0.8004254490,
	0.2307037839,
	0.9810499236,
	0.5381541783,
	0.8872874841,
	0.6653769981,
	0.8377534381,
	0.8681431252,
	0.1586599872,
	0.0549831458,
	0.9973847763,
	0.9108019046,
	0.4385422261,
	0.1563168308,
	0.6821758674,
	0.9137980125,
	0.9916620530,
	0.1960522080,
	0.6761687855,
	0.9241416981,
	0.7642704573,
	0.0109754419,
	0.6157040506,
	0.1864916793,
	0.9102394038,
	0.1269377956,
	0.1494527179,
	0.7279690762,
	0.6084438749,
	0.9596913982,
	0.0359010016,
	0.3491810797,
	0.5753422226,
	0.5335324313,
	0.4098570136,
	0.9649679164,
	0.7802921057,
	0.3747249844,
	0.2259296826,
	0.1655725816,
	0.0785496061,
	0.5332173825,
	0.2757694854,
	0.9552421387,
	0.1313712166,
	0.3643656038,
	0.8443843395,
	0.0503686726,
	0.9489764939,
	0.8895586926,
	0.9239028529,
	0.8420726841,
	0.2869306603,
	0.9000234572,
	0.2378131152,
	0.0595094050,
	0.6152596484,
	0.6039151447,
	0.2000584328,
	0.4393776687,
	0.9096006822,
	0.3834522338,
	0.7841755545,
	0.6242475879,
	0.0418772554,
	0.0079248387,
	0.1108265419,
	0.4193945396,
	0.8733707325,
	0.3543217302,
	0.6851578970,
	0.4381817124,
	0.1547934520,
	0.6545407892,
	0.7739354468,
	0.2184850671,
	0.2861217500,
	0.6236426055,
	0.9658918464,
	0.7538747987,
	0.9119208837,
	0.8540115140,
	0.1280075455,
	0.8568865096,
	0.8530251199,
	0.0662315563,
	0.3872571292,
	0.8712848256,
	0.5410103674,
	0.5969123866,
	0.2394799882,
	0.2935250924,
	0.7717448704,
	0.9906932242,
	0.3882945018,
	0.5254719584,
	0.3874072778,
	0.9175538079,
	0.3239135258,
	0.5959623799,
	0.4479117660,
	0.6053759078,
	0.4343444886,
	0.5012520008,
	0.8070047762,
	0.0789303424,
	0.9031800510,
	0.2786890730,
	0.2951352017,
	0.5179544106,
	0.8348994309,
	0.7818114507,
	0.9519077270,
	0.0154774730,
	0.4969410913,
	0.4974238643,
	0.7353687117,
	0.4960333512,
	0.5543598877,
	0.2762230418,
	0.3036935777,
	0.4890019408,
	0.1489038773,
	0.5227120002,
	0.7213270332,
	0.6162766334,
	0.9891364582,
	0.1098763704,
	0.0249298970,
	0.6169171437,
	0.4696974213,
	0.0504566224,
	0.8937903520,
	0.1081329429,
	0.6384693921,
	0.2491994222,
	0.5418314201,
	0.8078908032,
	0.2121197766,
	0.9874339226,
	0.9072059643,
	0.7221884030,
	0.2244311658,
	0.6453912065,
	0.4719594742,
	0.9367558232,
	0.8480946047,
	0.3353938368,
	0.5768321596,
	0.2835744608,
	0.7557351171,
	0.6449389165,
	0.1205096517,
	0.3816562668,
	0.5179382419,
	0.9278506630,
	0.8751347387,
	0.7672033732,
	0.0133372950,
	0.9322539228,
	0.4169386013,
	0.4971959568,
	0.7297106682,
	0.7062170463,
	0.1773818022,
	0.2378995547,
	0.2710544936,
	0.3991600896,
	0.7234168839,
	0.1754819564,
	0.1666623891,
	0.7591643120,
	0.8742704249,
	0.2112319020,
	0.7050036673,
	0.5010691541,
	0.5676037335,
	0.0544326396,
	0.0200170000,
	0.7747105506,
	0.9770879979,
	0.5497726776,
	0.4480169072,
	0.4870751859,
	0.3881607487,
	0.3125824204,
	0.8576147372,
	0.2534741189,
	0.4326200586,
	0.3328751211,
	0.1041890610,
	0.2188357972,
	0.4757202037,
	0.5119989205,
	0.8870386976,
	0.9861620997,
	0.3391555195,
	0.4120936382,
	0.3989047676,
	0.6387410872,
	0.9733232735,
	0.4246128953,
	0.6823413504,
	0.6789407621,
	0.3898480041,
	0.3457920028,
	0.4186463749,
	0.6304584204,
	0.3403721814,
	0.8459337448,
	0.0667460227,
	0.3494353433,
	0.9606754721,
	0.4464002733,
	0.0329249072,
	0.7907684790,
	0.3032391396,
	0.3336862099,
	0.6691396706,
	0.0909538465,
	0.1869305562,
	0.0943332695,
	0.4416604002,
	0.4725280728,
	0.9476503003,
	0.4330490471,
	0.2733061147,
	0.5347032812,
	0.2722883211,
	0.3837971993,
	0.5270003691,
	0.4365821551,
	0.7590410498,
	0.4093365845,
	0.2808802336,
	0.7556682200,
	0.6230928864,
	0.7225146050,
	0.9912101320,
	0.9759131238,
	0.7304804527,
	0.2075102763,
	0.8488812484,
	0.1257769816,
	0.2850648533,
	0.7837822051,
	0.9554622161,
	0.0073243907,
	0.0860152938,
	0.5100277120,
	0.9885086935,
	0.9124084860,
	0.9545690621,
	0.0840283663,
	0.0446729502,
	0.0783158173,
	0.3311390062,
	0.1689347241,
	0.4143836663,
	0.5689961923,
	0.5005996590,
	0.5495168734,
	0.5088196627,
	0.3554335610,
	0.9899560802,
	0.0020269172,
	0.3403837061,
	0.3378358853,
	0.8850536016,
	0.4482025405,
	0.2788022521,
	0.3552961214,
	0.3430100869,
	0.3529730719,
	0.6334934088,
	0.6135985895,
	0.8526412326,
	0.2912926813,
	0.8580680301,
	0.4887718319,
	0.1687572074,
	0.6078945864,
	0.8796877884,
	0.7652342912,
	0.1673172678,
	0.8888415409,
	0.0206101334,
	0.3645359295,
	0.0567146149,
	0.9541225307,
	0.8102134552,
	0.0024127812,
	0.2064902812,
	0.3920428452,
	0.7864458960,
	0.2861686961,
	0.4981773228,
	0.2057671730,
	0.9964745744,
	0.9961769118,
	0.3706029826,
	0.5144513888,
	0.8938448112,
	0.9605799327,
	0.1190349041,
	0.9893877973,
	0.0282244175,
	0.1767602834,
	0.4852861667,
	0.7175723054,
	0.7322225911,
	0.5226786961,
	0.6557636443,
	0.0007328371,
	0.4220989211,
	0.9685162481,
	0.4817454599,
	0.4881592383,
	0.5672801071,
	0.7157327285,
	0.6190943782,
	0.9025616525,
	0.0027861666,
	0.5956194647,
	0.5049317996,
	0.4181579130,
	0.5396790272,
	0.7140765985,
	0.9669660855,
	0.5379407584,
	0.1231692575,
	0.8112743215,
	0.8483747490,
	0.1185774847,
	0.6762947517,
	0.8887719687,
	0.8738138296,
	0.2754349842,
	0.2666185602,
	0.9187527734,
	0.7480679335,
	0.6208676954,
	0.4304985745,
	0.0150757564,
	0.0803651674,
	0.1101050646,
	0.3092760305,
	0.1838548502,
	0.6519407721,
	0.5123929072,
	0.5151868602,
	0.5242845824,
	0.6528797277,
	0.6339332088,
	0.3681235832,
	0.0760050880,
	0.2315506649,
	0.9611084881,
	0.5460075496,
	0.6086490065,
	0.7049584540,
	0.2026718290,
	0.2468813292,
	0.2504335612,
	0.8857992558,
	0.2308155526,
	0.8389296056,
	0.7373307736,
	0.9220181640,
	0.6975023699,
	0.9505543193,
	0.1101513685,
	0.6499663974,
	0.4060567980,
	0.0025370125,
	0.1790128792,
	0.8513624759,
}

// benchmark
func BenchmarkTGammaGo(b *testing.B) {
	for i := 0; i < b.N; i++ {
		for _, i := range datagamma {
			math.Gamma(i)
		}
	}
}

func BenchmarkTGammaC(b *testing.B) {
	for i := 0; i < b.N; i++ {
		for _, i := range datagamma {
			Ctgamma(i)
		}
	}
}

// benchmark
